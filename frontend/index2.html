<!doctype html>
<html lang="en">
<head><title>WebMPC</title>

<meta charset="utf-8">

<link rel="stylesheet" href="http://code.jquery.com/ui/1.11.0/themes/smoothness/jquery-ui.css">
<link rel="stylesheet" type="text/css" href="css/css.css">

<script src="js/jquery-1.10.2.min.js"></script>
<script src="js/jquery-ui-1.10.3.custom.min.js"></script>
<script src="js/module_loader.js"></script>

<script>

$(function() {

	var base_url = 'http://localhost:8888';

	ModuleLoader.on_all_modules_loaded = function() {
		var content = '';
		for (var i = 0; i < ModuleLoader.modules.length; i++) {
			var module = ModuleLoader.modules[i];
			// console.log("Loaded module " + module.title);

			// tab itself
			var tab = '<li><a href="#tabs-' + i + '">' + module.title + '</a></li>';
			$("#tab_list").html( $("#tab_list").html() + '\n' + tab );

			// tab content
			var tab_content = '\n<div id="tabs-' + i + '">\n' + module.content() + '\n</div>';
			$("#tabs").html( $("#tabs").html() + tab_content );

			module.base_url = base_url;
			module.start();
		}
		// console.log( $("#tab_list").html() );

		$( "#tabs" ).tabs().addClass( "ui-tabs-vertical ui-helper-clearfix" );
		$( "#tabs li" ).removeClass( "ui-corner-top" ).addClass( "ui-corner-left" );
	};

	$.get( base_url + '/modules')
		.done(
			function( data ) {
				ModuleLoader.load_modules( jQuery.parseJSON(data) );
			}
		)
	;

	window.setInterval(
		function() {
			for (var i = 0; i < ModuleLoader.modules.length; i++) {
				ModuleLoader.modules[i].update();
			}
		}, 5000
	);
});

</script>

</head>
<body>

<div id="tabs">
	<ul id="tab_list">
	</ul>
</div>

</body>
</html>
